{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/lib/WebGLApp.js","webpack:///./src/lib/loadTexture.js","webpack:///./src/lib/loadEnvMap.js","webpack:///./src/lib/AssetManager.js","webpack:///./src/scene/shaders/iridescence-all-colors.frag","webpack:///./src/lib/three-utils.js","webpack:///./src/scene/Ephebe.js","webpack:///./src/scene/shaders/iridescence.frag","webpack:///./src/lib/utils.js","webpack:///./src/scene/Hills.js","webpack:///./src/index.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","WebGLApp","_this","this","_ref","arguments","undefined","_ref$background","background","_ref$backgroundAlpha","backgroundAlpha","_ref$fov","fov","_ref$near","near","_ref$far","far","options","_objectWithoutProperties","_classCallCheck","_updateListeners","writable","_tmpTarget","THREE","_rafID","_lastTime","resize","_ref2","_ref2$width","width","innerWidth","_ref2$height","height","innerHeight","_ref2$pixelRatio","pixelRatio","Math","min","maxPixelRatio","devicePixelRatio","renderer","getPixelRatio","setPixelRatio","setSize","camera","isPerspectiveCamera","aspect","updateProjectionMatrix","composer","scene","traverse","obj","draw","saveScreenshot","_ref3","_ref3$width","_ref3$height","_ref3$fileName","fileName","dataURI","canvas","toDataURL","saveDataURI","update","dt","time","orbitControls","up","fromArray","position","_classPrivateFieldLooseBase","target","lookAt","world","step","bodies","forEach","body","tween","fn","passes","pass","isLastElement","renderToScreen","render","start","requestAnimationFrame","animate","isRunning","stop","cancelAnimationFrame","stats","begin","now","performance","maxDeltaTime","end","_len","args","Array","_key","child","_objectSpread","antialias","alpha","preserveDrawingBuffer","failIfMajorPerformanceCaveat","sortObjects","domElement","setClearColor","gl","getContext","addEventListener","touchHandler","createTouches","filtered","on","ev","pos","postprocessing","EffectComposer","addPass","RenderPass","createOrbitControls","element","parent","distance","showFps","Stats","showPanel","document","appendChild","dom","controls","controlsState","State","hideControls","wrapGUI","closeControls","controlsElement","querySelector","style","display","click","gpu","getGPUTier","glContext","type","tier","Number","isMobile","toLowerCase","includes","blob","dataURIToBlob","link","createElement","download","href","URL","createObjectURL","onclick","setTimeout","revokeObjectURL","removeAttribute","loadTexture","_x","_x2","_loadTexture","_callee","url","texture","image","regeneratorRuntime","wrap","_context","prev","next","encoding","setTextureParams","loadImage","crossorigin","sent","needsUpdate","abrupt","t0","Error","concat","opt","flipY","mapping","format","isJPEG","search","repeat","copy","wrapS","wrapT","minFilter","magFilter","generateMipmaps","loadEnvMap","_loadEnvMap","cubemapGenerator","cubeMapTexture","basePath","isHDR","extension","urls","equirectangular","EquirectangularToCubeGenerator","resolution","renderTarget","dispose","buildCubeMap","hdr","prefix","replace","postfix","Promise","resolve","reject","HDRCubeTextureLoader","load","map","cubeMap","pbr","level","pmremGenerator","PMREMGenerator","pmremCubeUVPacker","PMREMCubeUVPacker","cubeLods","CubeUVRenderTarget","idx","clamp","floor","AssetManager","TypeError","AssetManager_classPrivateFieldLooseBase","_cache","_onProgressListeners","AssetManager_objectWithoutProperties","_getQueued","_queue","AssetManager_objectSpread","_extractType","find","item","ext","lastIndexOf","test","itemLoadingStart","Date","_loadItem","DEBUG","console","log","prettyMs","error","queue","total","_this2","loadingStart","pMap","_ref4","AssetManager_asyncToGenerator","mark","_callee2","percent","_context2","logError","_x3","_x4","concurrency","_asyncConcurrency","errors","_logs","filter","groupLog","GLTFLoader","err","fetch","then","response","json","arrayBuffer","text","_len2","_key2","_console","groupCollapsed","_console2","_toConsumableArray","groupEnd","lib_AssetManager","iridescence_all_colors","shader","_ref$header","header","_ref$main","main","replaces","patchedShader","normalMaterialGlobalvert","normalMaterialGlobalvertPos","three_utils_objectWithoutProperties","keys","assets","Ephebe","_THREE$Group","webgl","Ephebe_objectWithoutProperties","Ephebe_classCallCheck","_possibleConstructorReturn","_getPrototypeOf","gltf","isMesh","ephebe","mixer","clip","animations","clone","clipAction","play","_this$webgl$controls$","powerFactor","speed","multiplicator","material","uniforms","vertexShader","fragmentShader","iridescenceAllColorsFrag","skinning","$onChanges","scale","multiplyScalar","rotateY","PI","translateX","add","_inherits","iridescence","simplex","SimplexNoise","noise","noise2D","noise3D","noise4D","PLANE_WIDTH","PLANE_DETAIL","displace","vertices","x","y","z","hypot","amplitude","pow","Hills","Hills_objectWithoutProperties","Hills_classCallCheck","Hills_possibleConstructorReturn","Hills_getPrototypeOf","hills","firstColor","secondColor","iridescenceFrag","geometry","rotateX","attributes","array","computeVertexNormals","mesh","Hills_inherits","location","Slider","max","phi","phiBounds","distanceBounds","visibility"],"mappings":"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","file":"app.c3972c7e.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([216,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// Inspiration for this class goes to Matt DesLauriers @mattdesl,\n// really awesome dude, give him a follow!\n// https://github.com/mattdesl/threejs-app/blob/master/src/webgl/WebGLApp.js\nimport * as THREE from 'three'\nimport createOrbitControls from 'orbit-controls'\nimport createTouches from 'touches'\nimport dataURIToBlob from 'datauritoblob'\nimport Stats from 'stats.js'\nimport State from 'controls-state'\nimport wrapGUI from 'controls-gui'\nimport { getGPUTier } from 'detect-gpu'\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer'\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass'\n\nexport default class WebGLApp {\n  #updateListeners = []\n  #tmpTarget = new THREE.Vector3()\n  #rafID\n  #lastTime\n\n  constructor({\n    background = '#000',\n    backgroundAlpha = 1,\n    fov = 45,\n    near = 0.01,\n    far = 100,\n    ...options\n  } = {}) {\n    this.renderer = new THREE.WebGLRenderer({\n      antialias: true,\n      alpha: false,\n      // enabled for saving screenshots of the canvas,\n      // may wish to disable this for perf reasons\n      preserveDrawingBuffer: true,\n      failIfMajorPerformanceCaveat: true,\n      ...options,\n    })\n\n    this.renderer.sortObjects = false\n    this.canvas = this.renderer.domElement\n\n    this.renderer.setClearColor(background, backgroundAlpha)\n\n    // clamp pixel ratio for performance\n    this.maxPixelRatio = options.maxPixelRatio || 2\n    // clamp delta to stepping anything too far forward\n    this.maxDeltaTime = options.maxDeltaTime || 1 / 30\n\n    // setup a basic camera\n    this.camera = new THREE.PerspectiveCamera(fov, 1, near, far)\n\n    this.scene = new THREE.Scene()\n\n    this.gl = this.renderer.getContext()\n\n    this.time = 0\n    this.isRunning = false\n    this.#lastTime = performance.now()\n    this.#rafID = null\n\n    // handle resize events\n    window.addEventListener('resize', this.resize)\n    window.addEventListener('orientationchange', this.resize)\n\n    // force an initial resize event\n    this.resize()\n\n    // __________________________ADDONS__________________________\n\n    // really basic touch handler that propagates through the scene\n    this.touchHandler = createTouches(this.canvas, {\n      target: this.canvas,\n      filtered: true,\n    })\n    this.touchHandler.on('start', (ev, pos) => this.traverse('onPointerDown', ev, pos))\n    this.touchHandler.on('move', (ev, pos) => this.traverse('onPointerMove', ev, pos))\n    this.touchHandler.on('end', (ev, pos) => this.traverse('onPointerUp', ev, pos))\n\n    // expose a composer for postprocessing passes\n    if (options.postprocessing) {\n      this.composer = new EffectComposer(this.renderer)\n      this.composer.addPass(new RenderPass(this.scene, this.camera))\n    }\n\n    // set up a simple orbit controller\n    if (options.orbitControls) {\n      this.orbitControls = createOrbitControls({\n        element: this.canvas,\n        parent: window,\n        distance: 5,\n        ...(options.orbitControls instanceof Object ? options.orbitControls : {}),\n      })\n\n      // move the camera position accordingly to the orbitcontrols options\n      this.camera.position.fromArray(this.orbitControls.position)\n      this.camera.lookAt(new THREE.Vector3().fromArray(this.orbitControls.target))\n    }\n\n    // Attach the Cannon physics engine\n    if (options.world) this.world = options.world\n\n    // Attach Tween.js\n    if (options.tween) this.tween = options.tween\n\n    // show the fps meter\n    if (options.showFps) {\n      this.stats = new Stats()\n      this.stats.showPanel(0)\n      document.body.appendChild(this.stats.dom)\n    }\n\n    // initialize the controls-state\n    if (options.controls) {\n      const controlsState = State(options.controls)\n      this.controls = options.hideControls ? controlsState : wrapGUI(controlsState)\n      if (options.closeControls) {\n        const controlsElement = document.querySelector('[class*=\"controlPanel\"]')\n\n        controlsElement.style.display = 'none'\n        const controlsButton = document.querySelector('[class*=\"controlPanel\"] button')\n        controlsButton.click()\n        controlsElement.style.display = 'block'\n      }\n    }\n\n    // detect the gpu info\n    const gpu = getGPUTier({ glContext: this.renderer.getContext() })\n    this.gpu = {\n      name: gpu.type,\n      tier: Number(gpu.tier.slice(-1)),\n      isMobile: gpu.tier.toLowerCase().includes('mobile'),\n    }\n  }\n\n  resize = ({\n    width = window.innerWidth,\n    height = window.innerHeight,\n    pixelRatio = Math.min(this.maxPixelRatio, window.devicePixelRatio),\n  } = {}) => {\n    this.width = width\n    this.height = height\n    this.pixelRatio = pixelRatio\n\n    // update pixel ratio if necessary\n    if (this.renderer.getPixelRatio() !== pixelRatio) {\n      this.renderer.setPixelRatio(pixelRatio)\n    }\n\n    // setup new size & update camera aspect if necessary\n    this.renderer.setSize(width, height)\n    if (this.camera.isPerspectiveCamera) {\n      this.camera.aspect = width / height\n    }\n    this.camera.updateProjectionMatrix()\n\n    // resize also the composer\n    if (this.composer) {\n      this.composer.setSize(pixelRatio * width, pixelRatio * height)\n    }\n\n    // recursively tell all child objects to resize\n    this.scene.traverse(obj => {\n      if (typeof obj.resize === 'function') {\n        obj.resize({\n          width,\n          height,\n          pixelRatio,\n        })\n      }\n    })\n\n    // draw a frame to ensure the new size has been registered visually\n    this.draw()\n    return this\n  }\n\n  // convenience function to trigger a PNG download of the canvas\n  saveScreenshot = ({ width = 2560, height = 1440, fileName = 'image.png' } = {}) => {\n    // force a specific output size\n    this.resize({ width, height, pixelRatio: 1 })\n    this.draw()\n\n    const dataURI = this.canvas.toDataURL('image/png')\n\n    // reset to default size\n    this.resize()\n    this.draw()\n\n    // save\n    saveDataURI(fileName, dataURI)\n  }\n\n  update = (dt, time) => {\n    if (this.orbitControls) {\n      this.orbitControls.update()\n\n      // reposition to orbit controls\n      this.camera.up.fromArray(this.orbitControls.up)\n      this.camera.position.fromArray(this.orbitControls.position)\n      this.#tmpTarget.fromArray(this.orbitControls.target)\n      this.camera.lookAt(this.#tmpTarget)\n    }\n\n    // recursively tell all child objects to update\n    this.scene.traverse(obj => {\n      if (typeof obj.update === 'function') {\n        obj.update(dt, time)\n      }\n    })\n\n    if (this.world) {\n      // update the Cannon physics engine\n      this.world.step(dt)\n\n      // recursively tell all child bodies to update\n      this.world.bodies.forEach(body => {\n        if (typeof body.update === 'function') {\n          body.update(dt, time)\n        }\n      })\n    }\n\n    if (this.tween) {\n      // update the Tween.js engine\n      this.tween.update()\n    }\n\n    // call the update listeners\n    this.#updateListeners.forEach(fn => fn(dt, time))\n\n    return this\n  }\n\n  onUpdate(fn) {\n    this.#updateListeners.push(fn)\n  }\n\n  draw = () => {\n    if (this.composer) {\n      // make sure to always render the last pass\n      this.composer.passes.forEach((pass, i, passes) => {\n        const isLastElement = i === passes.length - 1\n\n        if (isLastElement) {\n          pass.renderToScreen = true\n        } else {\n          pass.renderToScreen = false\n        }\n      })\n\n      this.composer.render()\n    } else {\n      this.renderer.render(this.scene, this.camera)\n    }\n    return this\n  }\n\n  start = () => {\n    if (this.#rafID !== null) return\n    this.#rafID = window.requestAnimationFrame(this.animate)\n    this.isRunning = true\n    return this\n  }\n\n  stop = () => {\n    if (this.#rafID === null) return\n    window.cancelAnimationFrame(this.#rafID)\n    this.#rafID = null\n    this.isRunning = false\n    return this\n  }\n\n  animate = () => {\n    if (!this.isRunning) return\n    window.requestAnimationFrame(this.animate)\n\n    if (this.stats) this.stats.begin()\n\n    const now = performance.now()\n    const dt = Math.min(this.maxDeltaTime, (now - this.#lastTime) / 1000)\n    this.time += dt\n    this.#lastTime = now\n    this.update(dt, this.time)\n    this.draw()\n\n    if (this.stats) this.stats.end()\n  }\n\n  traverse = (fn, ...args) => {\n    this.scene.traverse(child => {\n      if (typeof child[fn] === 'function') {\n        child[fn].apply(child, args)\n      }\n    })\n  }\n}\n\nfunction saveDataURI(name, dataURI) {\n  const blob = dataURIToBlob(dataURI)\n\n  // force download\n  const link = document.createElement('a')\n  link.download = name\n  link.href = window.URL.createObjectURL(blob)\n  link.onclick = setTimeout(() => {\n    window.URL.revokeObjectURL(blob)\n    link.removeAttribute('href')\n  }, 0)\n\n  link.click()\n}\n","// Inspiration for this code goes to Matt DesLauriers @mattdesl,\n// really awesome dude, give him a follow!\n// https://github.com/mattdesl/threejs-app/blob/master/src/util/loadTexture.js\nimport * as THREE from 'three'\nimport loadImage from 'image-promise'\n\nexport default async function loadTexture(url, options) {\n  const texture = new THREE.Texture()\n  texture.name = url\n  texture.encoding = options.encoding || THREE.LinearEncoding\n  setTextureParams(url, texture, options)\n\n  try {\n    const image = await loadImage(url, { crossorigin: 'anonymous' })\n\n    texture.image = image\n    texture.needsUpdate = true\n    if (options.renderer) {\n      // Force texture to be uploaded to GPU immediately,\n      // this will avoid \"jank\" on first rendered frame\n      // BUG this was removed in r103, wait for initTexture()\n      // https://github.com/mrdoob/three.js/issues/16338\n      // texture.setTexture2D(texture, 0)\n    }\n    return texture\n  } catch (err) {\n    throw new Error(`Could not load texture ${url}`)\n  }\n}\n\nfunction setTextureParams(url, texture, opt) {\n  if (typeof opt.flipY === 'boolean') texture.flipY = opt.flipY\n  if (typeof opt.mapping !== 'undefined') {\n    texture.mapping = opt.mapping\n  }\n  if (typeof opt.format !== 'undefined') {\n    texture.format = opt.format\n  } else {\n    // choose a nice default format\n    const isJPEG = url.search(/\\.(jpg|jpeg)$/) > 0 || url.search(/^data:image\\/jpeg/) === 0\n    texture.format = isJPEG ? THREE.RGBFormat : THREE.RGBAFormat\n  }\n  if (opt.repeat) texture.repeat.copy(opt.repeat)\n  texture.wrapS = opt.wrapS || THREE.ClampToEdgeWrapping\n  texture.wrapT = opt.wrapT || THREE.ClampToEdgeWrapping\n  texture.minFilter = opt.minFilter || THREE.LinearMipMapLinearFilter\n  texture.magFilter = opt.magFilter || THREE.LinearFilter\n  texture.generateMipmaps = opt.generateMipmaps !== false\n}\n","// Inspiration for this code goes to Matt DesLauriers @mattdesl,\n// really awesome dude, give him a follow!\n// https://github.com/mattdesl/threejs-app/blob/master/src/util/loadEnvMap.js\nimport * as THREE from 'three'\nimport clamp from 'lodash/clamp'\nimport { HDRCubeTextureLoader } from 'three/examples/jsm/loaders/HDRCubeTextureLoader'\nimport { PMREMGenerator } from 'three/examples/jsm/pmrem/PMREMGenerator'\nimport { PMREMCubeUVPacker } from 'three/examples/jsm/pmrem/PMREMCubeUVPacker'\nimport { EquirectangularToCubeGenerator } from 'three/examples/jsm/loaders/EquirectangularToCubeGenerator'\nimport loadTexture from './loadTexture'\n\nexport default async function loadEnvMap(url, options) {\n  const renderer = options.renderer\n\n  if (!renderer) {\n    throw new Error(`PBR Map requires renderer to passed in the options for ${url}!`)\n  }\n\n  if (options.equirectangular) {\n    const texture = await loadTexture(url, { renderer })\n\n    const cubemapGenerator = new EquirectangularToCubeGenerator(texture, { resolution: 1024 })\n\n    const cubeMapTexture = cubemapGenerator.update(renderer)\n\n    // renderTarget is used for the scene.background\n    cubeMapTexture.renderTarget = cubemapGenerator.renderTarget\n\n    texture.dispose() // dispose original texture\n    texture.image.data = null // remove Image reference\n\n    return buildCubeMap(cubeMapTexture, options)\n  }\n\n  const basePath = url\n\n  const isHDR = options.hdr\n  const extension = isHDR ? '.hdr' : '.png'\n  const urls = genCubeUrls(`${basePath.replace(/\\/$/, '')}/`, extension)\n\n  if (isHDR) {\n    // load a float HDR texture\n    return new Promise((resolve, reject) => {\n      new HDRCubeTextureLoader().load(\n        THREE.UnsignedByteType,\n        urls,\n        map => resolve(buildCubeMap(map, options)),\n        null,\n        () => reject(new Error(`Could not load PBR map: ${basePath}`))\n      )\n    })\n  }\n\n  // load a RGBM encoded texture\n  return new Promise((resolve, reject) => {\n    new THREE.CubeTextureLoader().load(\n      urls,\n      cubeMap => {\n        cubeMap.encoding = THREE.RGBM16Encoding\n        resolve(buildCubeMap(cubeMap, options))\n      },\n      null,\n      () => reject(new Error(`Could not load PBR map: ${basePath}`))\n    )\n  })\n}\n\nfunction buildCubeMap(cubeMap, options) {\n  if (options.pbr || typeof options.level === 'number') {\n    // prefilter the environment map for irradiance\n    const pmremGenerator = new PMREMGenerator(cubeMap)\n    pmremGenerator.update(options.renderer)\n    if (options.pbr) {\n      const pmremCubeUVPacker = new PMREMCubeUVPacker(pmremGenerator.cubeLods)\n      pmremCubeUVPacker.update(options.renderer)\n      const target = pmremCubeUVPacker.CubeUVRenderTarget\n      cubeMap = target.texture\n      pmremCubeUVPacker.dispose()\n    } else {\n      const idx = clamp(Math.floor(options.level), 0, pmremGenerator.cubeLods.length)\n      cubeMap = pmremGenerator.cubeLods[idx].texture\n    }\n    pmremGenerator.dispose()\n  }\n  if (options.mapping) cubeMap.mapping = options.mapping\n  return cubeMap\n}\n\nfunction genCubeUrls(prefix, postfix) {\n  return [\n    `${prefix}px${postfix}`,\n    `${prefix}nx${postfix}`,\n    `${prefix}py${postfix}`,\n    `${prefix}ny${postfix}`,\n    `${prefix}pz${postfix}`,\n    `${prefix}nz${postfix}`,\n  ]\n}\n","// Inspiration for this class goes to Matt DesLauriers @mattdesl,\n// really awesome dude, give him a follow!\n// https://github.com/mattdesl/threejs-app/blob/master/src/util/AssetManager.js\nimport pMap from 'p-map'\nimport prettyMs from 'pretty-ms'\nimport loadImage from 'image-promise'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\nimport loadTexture from './loadTexture'\nimport loadEnvMap from './loadEnvMap'\n\nclass AssetManager {\n  #queue = []\n  #cache = {}\n  #onProgressListeners = []\n  #asyncConcurrency = 10\n  #logs = []\n\n  addProgressListener(fn) {\n    if (typeof fn !== 'function') {\n      throw new TypeError('onProgress must be a function')\n    }\n    this.#onProgressListeners.push(fn)\n  }\n\n  // Add an asset to be queued, input: { url, type, ...options }\n  queue({ url, type, ...options }) {\n    if (!url) throw new TypeError('Must specify a URL or opt.url for AssetManager.queue()')\n    if (!this._getQueued(url)) {\n      this.#queue.push({ url, type: type || this._extractType(url), ...options })\n    }\n\n    return url\n  }\n\n  _getQueued(url) {\n    return this.#queue.find(item => item.url === url)\n  }\n\n  _extractType(url) {\n    const ext = url.slice(url.lastIndexOf('.'))\n\n    switch (true) {\n      case /\\.(gltf|glb)$/i.test(ext):\n        return 'gltf'\n      case /\\.json$/i.test(ext):\n        return 'json'\n      case /\\.svg$/i.test(ext):\n        return 'svg'\n      case /\\.(jpe?g|png|gif|bmp|tga|tif)$/i.test(ext):\n        return 'image'\n      case /\\.(wav|mp3)$/i.test(ext):\n        return 'audio'\n      case /\\.(mp4|webm|ogg|ogv)$/i.test(ext):\n        return 'video'\n      default:\n        throw new Error(`Could not load ${url}, unknown file extension!`)\n    }\n  }\n\n  // Fetch a loaded asset by URL\n  get = url => {\n    if (!url) throw new TypeError('Must specify an URL for AssetManager.get()')\n    if (!(url in this.#cache)) {\n      throw new Error(`The asset ${url} is not in the loaded files.`)\n    }\n\n    return this.#cache[url]\n  }\n\n  // Loads a single asset\n  async loadSingle({ renderer, ...item }) {\n    // renderer is used to load textures and env maps,\n    // but require it always since it is an extensible pattern\n    if (!renderer) {\n      throw new Error('You must provide a renderer to the loadSingle function.')\n    }\n\n    try {\n      const itemLoadingStart = Date.now()\n\n      this.#cache[item.url] = await this._loadItem({ renderer, ...item })\n\n      if (window.DEBUG) {\n        console.log(\n          `📦 Loaded single asset %c${item.url}%c in ${prettyMs(Date.now() - itemLoadingStart)}`,\n          'color:blue',\n          'color:black'\n        )\n      }\n\n      return item.url\n    } catch (err) {\n      delete this.#cache[item.url]\n      console.error(`📦  Could not load ${item.url}:\\n${err}`)\n    }\n  }\n\n  // Loads all queued assets\n  async load({ renderer }) {\n    // renderer is used to load textures and env maps,\n    // but require it always since it is an extensible pattern\n    if (!renderer) {\n      throw new Error('You must provide a renderer to the load function.')\n    }\n\n    const queue = this.#queue.slice()\n    this.#queue.length = 0 // clear queue\n\n    const total = queue.length\n    if (total === 0) {\n      // resolve first this functions and then call the progress listeners\n      setTimeout(() => this.#onProgressListeners.forEach(fn => fn(1)), 0)\n      return\n    }\n\n    const loadingStart = Date.now()\n\n    await pMap(\n      queue,\n      async (item, i) => {\n        try {\n          const itemLoadingStart = Date.now()\n\n          this.#cache[item.url] = await this._loadItem({ renderer, ...item })\n\n          if (window.DEBUG) {\n            this.log(\n              `Loaded %c${item.url}%c in ${prettyMs(Date.now() - itemLoadingStart)}`,\n              'color:blue',\n              'color:black'\n            )\n          }\n        } catch (err) {\n          this.logError(`Skipping ${item.url} from asset loading:\\n${err}`)\n        }\n\n        const percent = (i + 1) / total\n        this.#onProgressListeners.forEach(fn => fn(percent))\n      },\n      { concurrency: this.#asyncConcurrency }\n    )\n\n    if (window.DEBUG) {\n      const errors = this.#logs.filter(log => log.type === 'error')\n\n      this.groupLog(\n        `📦 Assets loaded in ${prettyMs(Date.now() - loadingStart)} ⏱ ${\n          errors.length > 0\n            ? `%c ⚠️ Skipped ${errors.length} asset${errors.length > 1 ? 's' : ''} `\n            : ''\n        }`,\n        errors.length > 0 ? 'color:white;background:red;' : ''\n      )\n    }\n  }\n\n  // Loads a single asset on demand, returning from\n  // cache if it exists otherwise adding it to the cache\n  // after loading.\n  async _loadItem({ url, type, renderer, ...options }) {\n    if (url in this.#cache) {\n      return this.#cache[url]\n    }\n\n    switch (type) {\n      case 'gltf':\n        return new Promise((resolve, reject) => {\n          new GLTFLoader().load(url, resolve, null, err =>\n            reject(new Error(`Could not load GLTF asset ${url}:\\n${err}`))\n          )\n        })\n      case 'json':\n        return fetch(url).then(response => response.json())\n      case 'env-map':\n        return loadEnvMap(url, { renderer, ...options })\n      case 'svg':\n      case 'image':\n        return loadImage(url, { crossorigin: 'anonymous' })\n      case 'texture':\n        return loadTexture(url, { renderer, ...options })\n      case 'audio':\n        // You might not want to load big audio files and\n        // store them in memory, that might be inefficient.\n        // Rather load them outside of the queue\n        return fetch(url).then(response => response.arrayBuffer())\n      case 'video':\n        // You might not want to load big video files and\n        // store them in memory, that might be inefficient.\n        // Rather load them outside of the queue\n        return fetch(url).then(response => response.blob())\n      default:\n        throw new Error(`Could not load ${url}, the type ${type} is unknown!`)\n    }\n  }\n\n  log(...text) {\n    this.#logs.push({ type: 'log', text })\n  }\n\n  logError(...text) {\n    this.#logs.push({ type: 'error', text })\n  }\n\n  groupLog(...text) {\n    console.groupCollapsed(...text)\n    this.#logs.forEach(log => {\n      console[log.type](...log.text)\n    })\n    console.groupEnd()\n\n    this.#logs.length = 0 // clear logs\n  }\n}\n\n// asset manager is a singleton, you can require it from\n// different files and use the same instance.\n// A plain js object would have worked just fine,\n// fucking java patterns\nexport default new AssetManager()\n","export default \"#define GLSLIFY 1\\nfloat hue2rgb(float f1, float f2, float hue) {\\n    if (hue < 0.0)\\n        hue += 1.0;\\n    else if (hue > 1.0)\\n        hue -= 1.0;\\n    float res;\\n    if ((6.0 * hue) < 1.0)\\n        res = f1 + (f2 - f1) * 6.0 * hue;\\n    else if ((2.0 * hue) < 1.0)\\n        res = f2;\\n    else if ((3.0 * hue) < 2.0)\\n        res = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;\\n    else\\n        res = f1;\\n    return res;\\n}\\n\\nvec3 hsl2rgb(vec3 hsl) {\\n    vec3 rgb;\\n    \\n    if (hsl.y == 0.0) {\\n        rgb = vec3(hsl.z); // Luminance\\n    } else {\\n        float f2;\\n        \\n        if (hsl.z < 0.5)\\n            f2 = hsl.z * (1.0 + hsl.y);\\n        else\\n            f2 = hsl.z + hsl.y - hsl.y * hsl.z;\\n            \\n        float f1 = 2.0 * hsl.z - f2;\\n        \\n        rgb.r = hue2rgb(f1, f2, hsl.x + (1.0/3.0));\\n        rgb.g = hue2rgb(f1, f2, hsl.x);\\n        rgb.b = hue2rgb(f1, f2, hsl.x - (1.0/3.0));\\n    }   \\n    return rgb;\\n}\\n\\nvec3 hsl2rgb(float h, float s, float l) {\\n    return hsl2rgb(vec3(h, s, l));\\n}\\n\\nuniform float time;\\nuniform float powerFactor;\\nuniform float multiplicator;\\nuniform float speed;\\n\\nvarying vec3 vNormal;\\nvarying vec3 vPosition;\\n\\nvoid main() {\\n  // The camera sometimes would be too close to the position,\\n  // so the vector would point to the negative position.\\n  // Multiplicating the camera position by a big number fixes it.\\n  vec3 cameraDirection = normalize(cameraPosition * 1000.0 - vPosition);\\n\\n  float iridescence = pow(dot(vNormal, cameraDirection), powerFactor) * multiplicator;\\n\\n  // circle the hue\\n  float hue = mod(iridescence + time * speed, 1.0);\\n  vec3 color = hsl2rgb(hue, 1.0, 0.5);\\n\\n  gl_FragColor = vec4(color, 1.0);\\n}\\n\"","import * as THREE from 'three'\n\n// like MeshNormalMaterial, but the normals are relative to world not camera\nconst normalMaterialGlobalvert = THREE.ShaderChunk['normal_vert'].replace(\n  '#include <defaultnormal_vertex>',\n  THREE.ShaderChunk['defaultnormal_vertex'].replace(\n    'transformedNormal = normalMatrix * transformedNormal;',\n    // take into consideration only the model matrix\n    'transformedNormal = mat3(modelMatrix) * transformedNormal;'\n  )\n)\n\nexport const normalMaterialGlobalvertPos = monkeyPatch(normalMaterialGlobalvert, {\n  header: 'varying vec3 vPosition;',\n  main: 'vPosition = position;',\n})\n\nexport function monkeyPatch(shader, { header = '', main = '', ...replaces }) {\n  let patchedShader = shader\n\n  Object.keys(replaces).forEach(key => {\n    patchedShader = patchedShader.replace(key, replaces[key])\n  })\n\n  return patchedShader.replace(\n    'void main() {',\n    `\n    ${header}\n    void main() {\n      ${main}\n    `\n  )\n}\n","import * as THREE from 'three'\nimport assets from '../lib/AssetManager'\nimport iridescenceAllColorsFrag from './shaders/iridescence-all-colors.frag'\nimport { normalMaterialGlobalvertPos } from '../lib/three-utils'\n\nconst key = assets.queue({\n  url: 'assets/ephebe_twerking.glb',\n  type: 'gltf',\n})\n\nexport class Ephebe extends THREE.Group {\n  constructor({ webgl, ...options }) {\n    super(options)\n    this.webgl = webgl\n\n    const gltf = assets.get(key)\n    // BUG gltf.scene.clone() doesn't clone .skinning\n    const scene = gltf.scene\n    scene.traverse(child => {\n      if (child.isMesh) {\n        this.ephebe = child\n      }\n    })\n\n    this.mixer = new THREE.AnimationMixer(scene)\n    const clip = gltf.animations[0].clone()\n    this.mixer.clipAction(clip).play()\n\n    const { powerFactor, speed, multiplicator } = this.webgl.controls.ephebe\n\n    this.ephebe.material = new THREE.ShaderMaterial({\n      uniforms: {\n        time: { value: 0.0 },\n        powerFactor: { value: powerFactor },\n        speed: { value: speed },\n        multiplicator: { value: multiplicator },\n      },\n      vertexShader: normalMaterialGlobalvertPos,\n      fragmentShader: iridescenceAllColorsFrag,\n    })\n    this.ephebe.material.skinning = true\n\n    this.webgl.controls.$onChanges(controls => {\n      if (controls['ephebe.powerFactor']) {\n        this.ephebe.material.uniforms.powerFactor.value = controls['ephebe.powerFactor'].value\n      }\n      if (controls['ephebe.speed']) {\n        this.ephebe.material.uniforms.speed.value = controls['ephebe.speed'].value\n      }\n      if (controls['ephebe.multiplicator']) {\n        this.ephebe.material.uniforms.multiplicator.value = controls['ephebe.multiplicator'].value\n      }\n    })\n\n    scene.scale.multiplyScalar(0.25)\n    scene.rotateY(Math.PI)\n    scene.translateX(-0.1)\n\n    this.add(scene)\n  }\n\n  update(dt, time) {\n    this.mixer.update(dt)\n\n    this.ephebe.material.uniforms.time.value = time\n  }\n}\n","export default \"#define GLSLIFY 1\\nfloat hue2rgb(float f1, float f2, float hue) {\\n    if (hue < 0.0)\\n        hue += 1.0;\\n    else if (hue > 1.0)\\n        hue -= 1.0;\\n    float res;\\n    if ((6.0 * hue) < 1.0)\\n        res = f1 + (f2 - f1) * 6.0 * hue;\\n    else if ((2.0 * hue) < 1.0)\\n        res = f2;\\n    else if ((3.0 * hue) < 2.0)\\n        res = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;\\n    else\\n        res = f1;\\n    return res;\\n}\\n\\nvec3 hsl2rgb(vec3 hsl) {\\n    vec3 rgb;\\n    \\n    if (hsl.y == 0.0) {\\n        rgb = vec3(hsl.z); // Luminance\\n    } else {\\n        float f2;\\n        \\n        if (hsl.z < 0.5)\\n            f2 = hsl.z * (1.0 + hsl.y);\\n        else\\n            f2 = hsl.z + hsl.y - hsl.y * hsl.z;\\n            \\n        float f1 = 2.0 * hsl.z - f2;\\n        \\n        rgb.r = hue2rgb(f1, f2, hsl.x + (1.0/3.0));\\n        rgb.g = hue2rgb(f1, f2, hsl.x);\\n        rgb.b = hue2rgb(f1, f2, hsl.x - (1.0/3.0));\\n    }   \\n    return rgb;\\n}\\n\\nvec3 hsl2rgb(float h, float s, float l) {\\n    return hsl2rgb(vec3(h, s, l));\\n}\\n\\nuniform float time;\\nuniform float powerFactor;\\nuniform float multiplicator;\\nuniform float speed;\\nuniform vec3 firstColor;\\nuniform vec3 secondColor;\\n\\nvarying vec3 vNormal;\\nvarying vec3 vPosition;\\n\\nvoid main() {\\n  // The camera sometimes would be too close to the position,\\n  // so the vector would point to the negative position.\\n  // Multiplicating the camera position by a big number fixes it.\\n  vec3 cameraDirection = normalize(cameraPosition * 1000.0 - vPosition);\\n\\n  float iridescence = pow(dot(vNormal, cameraDirection), powerFactor) * multiplicator;\\n\\n  // show all colors\\n  float hue = mod(iridescence + time * speed, 1.0);\\n  vec3 rainbowColor = hsl2rgb(hue, 1.0, 0.5);\\n\\n  // alternate between two colors,\\n  // the function looks like this /\\\\/\\\\/\\\\/\\\\/\\n  vec3 color = mix(firstColor, secondColor, abs(1.0 - mod(iridescence + time * speed, 2.0)));\\n\\n  gl_FragColor = vec4(color, 1.0);\\n}\\n\"","import SimplexNoise from 'simplex-noise'\n\n// wrapper with processing-like api of the library simplex-noise\nconst simplex = new SimplexNoise()\nexport function noise(...args) {\n  switch (args.length) {\n    case 1:\n      return simplex.noise2D(0, args[0])\n    case 2:\n      return simplex.noise2D(args[0], args[1])\n    case 3:\n      return simplex.noise3D(args[0], args[1], args[2])\n    case 4:\n      return simplex.noise4D(args[0], args[1], args[2], args[3])\n    default:\n      throw new Error(`Invalid number of arguments passed to the noise() function`)\n  }\n}\n","import * as THREE from 'three'\nimport iridescenceFrag from './shaders/iridescence.frag'\nimport { normalMaterialGlobalvertPos } from '../lib/three-utils'\nimport { noise } from '../lib/utils'\n\nconst PLANE_WIDTH = 20\nconst PLANE_DETAIL = 256\n\nfunction displace(vertices, time = 0) {\n  for (let i = 0; i < vertices.length; i += 3) {\n    const x = i\n    const y = i + 1\n    const z = i + 2\n\n    // distance from center\n    const distance = Math.hypot(vertices[x], vertices[z])\n\n    // const amplitude = distance ** 3 * 0.01\n    const amplitude = distance ** 2 * 0.05\n\n    const frequency = 0.4\n    const speed = 0.05\n    vertices[y] =\n      (noise(vertices[x] * frequency, vertices[z] * frequency, time * speed) * 0.5 + 0.5) *\n      amplitude\n  }\n}\n\nexport class Hills extends THREE.Group {\n  constructor({ webgl, ...options }) {\n    super(options)\n    this.webgl = webgl\n\n    const { powerFactor, speed, multiplicator, firstColor, secondColor } = this.webgl.controls.hills\n\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        time: { value: 0.0 },\n        powerFactor: { value: powerFactor },\n        speed: { value: speed },\n        multiplicator: { value: multiplicator },\n        firstColor: { type: 'c', value: new THREE.Color(firstColor) },\n        secondColor: { type: 'c', value: new THREE.Color(secondColor) },\n      },\n      vertexShader: normalMaterialGlobalvertPos,\n      fragmentShader: iridescenceFrag,\n    })\n\n    this.webgl.controls.$onChanges(controls => {\n      if (controls['hills.powerFactor']) {\n        this.material.uniforms.powerFactor.value = controls['hills.powerFactor'].value\n      }\n      if (controls['hills.speed']) {\n        this.material.uniforms.speed.value = controls['hills.speed'].value\n      }\n      if (controls['hills.multiplicator']) {\n        this.material.uniforms.multiplicator.value = controls['hills.multiplicator'].value\n      }\n      if (controls['hills.firstColor']) {\n        this.material.uniforms.firstColor.value = new THREE.Color(\n          controls['hills.firstColor'].value\n        )\n      }\n      if (controls['hills.secondColor']) {\n        this.material.uniforms.secondColor.value = new THREE.Color(\n          controls['hills.secondColor'].value\n        )\n      }\n    })\n\n    this.geometry = new THREE.PlaneBufferGeometry(\n      PLANE_WIDTH,\n      PLANE_WIDTH,\n      PLANE_DETAIL,\n      PLANE_DETAIL\n    )\n\n    this.geometry.rotateX(-Math.PI / 2)\n\n    displace(this.geometry.attributes.position.array)\n    this.geometry.computeVertexNormals()\n\n    this.mesh = new THREE.Mesh(this.geometry, this.material)\n    this.add(this.mesh)\n  }\n\n  update(dt, time) {\n    this.material.uniforms.time.value = time\n\n    displace(this.geometry.attributes.position.array, time)\n    this.geometry.attributes.position.needsUpdate = true\n    this.geometry.computeVertexNormals()\n  }\n}\n","import State from 'controls-state'\nimport WebGLApp from './lib/WebGLApp'\nimport assets from './lib/AssetManager'\nimport { Ephebe } from './scene/Ephebe'\nimport { Hills } from './scene/Hills'\n\nwindow.DEBUG = window.location.search.includes('debug')\n\n// grab our canvas\nconst canvas = document.querySelector('#app')\n\n// setup the WebGLRenderer\nconst webgl = new WebGLApp({\n  canvas,\n  controls: {\n    background: '#070758',\n    ephebe: {\n      powerFactor: State.Slider(0.8, {\n        min: 0.01,\n        max: 5,\n        step: 0.01,\n      }),\n      speed: State.Slider(0.1, {\n        min: 0.01,\n        max: 10,\n        step: 0.01,\n      }),\n      multiplicator: State.Slider(0.6, {\n        min: 0.01,\n        max: 10,\n        step: 0.01,\n      }),\n    },\n    hills: {\n      powerFactor: State.Slider(1.13, {\n        min: 0.01,\n        max: 5,\n        step: 0.01,\n      }),\n      speed: State.Slider(0.3, {\n        min: 0.01,\n        max: 10,\n        step: 0.01,\n      }),\n      multiplicator: State.Slider(2.5, {\n        min: 0.01,\n        max: 20,\n        step: 0.01,\n      }),\n      firstColor: '#CE1DC5',\n      secondColor: '#00E6CC',\n    },\n  },\n  closeControls: !window.DEBUG,\n  showFps: window.DEBUG,\n  orbitControls: {\n    distance: 5,\n    target: [0, 1.2, 0],\n    phi: Math.PI * 0.4,\n    phiBounds: !window.DEBUG && [0, Math.PI * 0.5],\n    distanceBounds: !window.DEBUG && [5, 5],\n  },\n})\n\n// change the background color on controls changes\nwebgl.renderer.setClearColor(webgl.controls.background, 1)\nwebgl.controls.$onChanges(({ background }) => {\n  if (background) {\n    webgl.renderer.setClearColor(background.value, 1)\n  }\n})\n\n// attach it to the window to inspect in the console\nif (window.DEBUG) {\n  window.webgl = webgl\n}\n\n// hide canvas\nwebgl.canvas.style.visibility = 'hidden'\n\n// load any queued assets\nassets.load({ renderer: webgl.renderer }).then(() => {\n  // show canvas\n  webgl.canvas.style.visibility = ''\n\n  // add any \"WebGL components\" here...\n  // append them to the scene so you can\n  // use them from other components easily\n  webgl.scene.ephebe = new Ephebe({ webgl })\n  webgl.scene.add(webgl.scene.ephebe)\n  webgl.scene.hills = new Hills({ webgl })\n  webgl.scene.add(webgl.scene.hills)\n\n  // start animation loop\n  webgl.start()\n  webgl.draw()\n})\n"],"sourceRoot":""}