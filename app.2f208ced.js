!function(e){function t(t){for(var r,a,c=t[0],s=t[1],l=t[2],f=0,d=[];f<c.length;f++)a=c[f],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(u&&u(t);d.length;)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==o[s]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={0:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=s;i.push([349,1]),n()}({258:function(e,t){},349:function(e,t,n){"use strict";n.r(t);n(18),n(36),n(17),n(30),n(79),n(187),n(22),n(82);var r,o=n(100),i=n.n(o),a=n(0),c=n(5),s=n(158),l=n.n(s),u=(n(40),n(51),n(132),n(228),n(229),n(159)),f=n(160),d=n.n(f),p=n(161),h=n.n(p),v=n(162),m=n(163),b=n.n(m),y=(n(85),n(135),n(86),n(245),n(247),n(248),n(249),n(250),n(101)),g=n.n(y),w=n(164),x=n.n(w);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var k={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function S(e,t){return Object.fromEntries(Object.entries(e).map((function(e,n){var r=j(e,2),o=r[0],i=r[1];return[o,t(i,o,n)]})))}function E(e){return g.a.Slider(e.value,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({min:e.min,max:e.max,step:e.step||.01},"exp"===e.scale&&{min:e.min||.001,step:e.step||.001,mapping:function(e){return Math.pow(10,e)},inverseMapping:Math.log10}))}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=S(e,(function(e){return"object"==typeof e&&(e.hasOwnProperty("value")||e.hasOwnProperty("max")||e.hasOwnProperty("min")||e.hasOwnProperty("step"))?E(e):"object"==typeof e?S(e,(function(e){return"object"==typeof e&&(e.hasOwnProperty("value")||e.hasOwnProperty("max")||e.hasOwnProperty("min")||e.hasOwnProperty("step"))?E(e):e})):e})),o=g()(n),i=t.hideControls?o:x()(o,{expanded:!t.closeControls});if(!t.hideControls){var a='\n      [class^="controlPanel-"] [class*="__field"]::before {\n        content: initial !important;\n      }\n      [class^="controlPanel-"] [class*="__labelText"] {\n        text-indent: 6px !important;\n      }\n      [class^="controlPanel-"] [class*="__field--button"] > button::before {\n        content: initial !important;\n      }\n    ',c=document.createElement("style");c.type="text/css",c.innerHTML=a,document.head.appendChild(c)}return r=i,i}function D(e){"}"===e.slice(-1)&&(e=e.slice(0,-1));var t=e.indexOf(".controls.")+".controls.".length;return(e=e.slice(t)).trim()}function R(e,t){var n=D(t.toString()),o=n.includes(".")?n.slice(n.lastIndexOf(".")+1):n;r.$onChanges((function(t){t[n]&&(e.uniforms[o].value.isColor?e.uniforms[o].value.set(t[n].value):e.uniforms[o].value=t[n].value)}));var i=t();return"string"==typeof i&&(i.startsWith("#")||i in k)&&(i=new a.n(i)),{value:i}}function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t,n){return t&&U(e.prototype,t),n&&U(e,n),e}function F(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var N=0;function B(e){return"__private_"+N+++"_"+e}var q=B("width"),H=B("height"),G=B("capturer"),W=B("lastTime"),X=B("updateListeners"),Y=B("pointerdownListeners"),$=B("pointermoveListeners"),J=B("pointerupListeners"),Q=B("startX"),V=B("startY"),K=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.background,o=void 0===r?"#111":r,i=n.backgroundAlpha,s=void 0===i?1:i,l=n.fov,f=void 0===l?45:l,d=n.frustumSize,p=void 0===d?3:d,m=n.near,y=void 0===m?.01:m,g=n.far,w=void 0===g?100:g,x=L(n,["background","backgroundAlpha","fov","frustumSize","near","far"]);z(this,e),Object.defineProperty(this,q,{writable:!0,value:void 0}),Object.defineProperty(this,H,{writable:!0,value:void 0}),Object.defineProperty(this,G,{writable:!0,value:void 0}),this.isRunning=!1,this.time=0,this.dt=0,Object.defineProperty(this,W,{writable:!0,value:performance.now()}),Object.defineProperty(this,X,{writable:!0,value:[]}),Object.defineProperty(this,Y,{writable:!0,value:[]}),Object.defineProperty(this,$,{writable:!0,value:[]}),Object.defineProperty(this,J,{writable:!0,value:[]}),Object.defineProperty(this,Q,{writable:!0,value:void 0}),Object.defineProperty(this,V,{writable:!0,value:void 0}),this.resize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,r=void 0===n?t.width:n,o=e.height,i=void 0===o?t.height:o,a=e.pixelRatio,c=void 0===a?t.pixelRatio:a;if(t.renderer.getPixelRatio()!==c&&t.renderer.setPixelRatio(c),t.renderer.setSize(r,i),t.camera.isPerspectiveCamera)t.camera.aspect=r/i;else{var s=r/i;t.camera.left=-t.camera.frustumSize*s/2,t.camera.right=t.camera.frustumSize*s/2,t.camera.top=t.camera.frustumSize/2,t.camera.bottom=-t.camera.frustumSize/2}return t.camera.updateProjectionMatrix(),t.composer&&t.composer.setSize(),t.scene.traverse((function(e){"function"==typeof e.resize&&e.resize({width:r,height:i,pixelRatio:c})})),t.draw(),t},this.saveScreenshot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,r=void 0===n?1920:n,o=e.height,i=void 0===o?1080:o,a=e.fileName,c=void 0===a?"Screenshot.png":a;t.resize({width:r,height:i,pixelRatio:1}),t.draw();var s=t.canvas.toDataURL("image/png");t.resize(),t.draw(),Z(c,s)},this.startRecording=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,r=void 0===n?1920:n,o=e.height,i=void 0===o?1080:o,a=e.fileName,c=void 0===a?"Recording":a,s=e.format,l=void 0===s?"gif":s,u=L(e,["width","height","fileName","format"]);F(t,G)[G]||(t.resize({width:r,height:i,pixelRatio:1}),t.draw(),F(t,G)[G]=new b.a(M({format:l,name:c,workersPath:"",motionBlurFrames:2},u)),F(t,G)[G].start())},this.stopRecording=function(){F(t,G)[G]&&(F(t,G)[G].stop(),F(t,G)[G].save(),F(t,G)[G]=void 0,t.resize(),t.draw())},this.update=function(e,n,r){return t.orbitControls&&t.orbitControls.update(),t.scene.traverse((function(t){"function"!=typeof t.update||t.isTransformControls||t.update(e,n,r)})),t.world&&(t.world.step(1/60,e),t.cannonDebugger&&t.cannonDebugger.update(),t.world.bodies.forEach((function(t){"function"==typeof t.update&&t.update(e,n)}))),F(t,X)[X].forEach((function(t){return t(e,n,r)})),t},this.draw=function(){var e=t.renderer.xr.enabled&&t.renderer.xr.isPresenting;return t.composer&&!e?t.composer.render(t.dt):t.renderer.render(t.scene,t.camera),t},this.start=function(){if(!t.isRunning)return t.isRunning=!0,t.draw(),t.renderer.setAnimationLoop(t.animate),t},this.stop=function(){if(t.isRunning)return t.renderer.setAnimationLoop(null),t.isRunning=!1,t},this.animate=function(e,n){t.isRunning&&(t.stats&&t.stats.begin(),t.dt=Math.min(t.maxDeltaTime,(e-F(t,W)[W])/1e3),t.time+=t.dt,F(t,W)[W]=e,t.update(t.dt,t.time,n),t.draw(),F(t,G)[G]&&F(t,G)[G].capture(t.canvas),t.stats&&t.stats.end())},this.renderer=new a.oc(M({antialias:!x.postprocessing,alpha:1!==s,preserveDrawingBuffer:!0},x)),void 0!==x.sortObjects&&(this.renderer.sortObjects=x.sortObjects),x.gamma&&(this.renderer.outputEncoding=a.pc),x.xr&&(this.renderer.xr.enabled=!0),this.canvas=this.renderer.domElement,this.renderer.setClearColor(o,s),F(this,q)[q]=x.width,F(this,H)[H]=x.height,this.maxPixelRatio=x.maxPixelRatio||1.5,this.maxDeltaTime=x.maxDeltaTime||1/30;var O=F(this,q)[q]/F(this,H)[H];if(x.orthographic?(this.camera=new a.wb(-p*O/2,p*O/2,p/2,-p/2,y,w),this.camera.frustumSize=p):this.camera=new a.yb(f,O,y,w),this.camera.position.copy(x.cameraPosition||new a.jc(0,0,4)),this.camera.lookAt(0,0,0),this.scene=new a.Qb,this.gl=this.renderer.getContext(),window.addEventListener("resize",this.resize),window.addEventListener("orientationchange",this.resize),this.resize(),this.isDragging=!1,this.canvas.addEventListener("pointerdown",(function(e){e.isPrimary&&(t.isDragging=!0,F(t,Q)[Q]=e.offsetX,F(t,V)[V]=e.offsetY,t.scene.traverse((function(t){"function"==typeof t.onPointerDown&&t.onPointerDown(e,{x:e.offsetX,y:e.offsetY})})),F(t,Y)[Y].forEach((function(t){return t(e,{x:e.offsetX,y:e.offsetY})})))})),this.canvas.addEventListener("pointermove",(function(e){if(e.isPrimary){var n=M(M({x:e.offsetX,y:e.offsetY},void 0!==F(t,Q)[Q]&&{dragX:e.offsetX-F(t,Q)[Q]}),void 0!==F(t,V)[V]&&{dragY:e.offsetY-F(t,V)[V]});t.scene.traverse((function(t){"function"==typeof t.onPointerMove&&t.onPointerMove(e,n)})),F(t,$)[$].forEach((function(t){return t(e,n)}))}})),this.canvas.addEventListener("pointerup",(function(e){if(e.isPrimary){t.isDragging=!1;var n=M(M({x:e.offsetX,y:e.offsetY},void 0!==F(t,Q)[Q]&&{dragX:e.offsetX-F(t,Q)[Q]}),void 0!==F(t,V)[V]&&{dragY:e.offsetY-F(t,V)[V]});t.scene.traverse((function(t){"function"==typeof t.onPointerUp&&t.onPointerUp(e,n)})),F(t,J)[J].forEach((function(t){return t(e,n)})),F(t,Q)[Q]=void 0,F(t,V)[V]=void 0}})),x.postprocessing){var P=this.gl.getParameter(this.gl.MAX_SAMPLES);this.composer=new c.c(this.renderer,M({multisampling:Math.min(8,P),frameBufferType:x.gamma?a.G:void 0},x)),this.composer.addPass(new c.g(this.scene,this.camera))}x.orbitControls&&(this.orbitControls=new u.a(this.camera,this.canvas),this.orbitControls.enableDamping=!0,this.orbitControls.dampingFactor=.15,this.orbitControls.enablePan=!1,x.orbitControls instanceof Object&&Object.keys(x.orbitControls).forEach((function(e){t.orbitControls[e]=x.orbitControls[e]}))),x.world&&(this.world=x.world,x.showWorldWireframes&&(this.cannonDebugger=cannonDebugger(this.scene,this.world.bodies,{autoUpdate:!1}))),x.showFps&&(this.stats=new h.a,this.stats.showPanel(0),document.body.appendChild(this.stats.dom)),x.controls&&(this.controls=C(x.controls,x)),this.loadGPUTier=Object(v.a)({glContext:this.gl}).then((function(e){t.gpu={name:e.gpu,tier:e.tier,isMobile:e.isMobile,fps:e.fps}}))}return I(e,[{key:"background",get:function(){return this.renderer.getClearColor(new a.n)},set:function(e){this.renderer.setClearColor(e,this.backgroundAlpha)}},{key:"backgroundAlpha",get:function(){return this.renderer.getClearAlpha()},set:function(e){this.renderer.setClearColor(this.background,e)}},{key:"isRecording",get:function(){return Boolean(F(this,G)[G])}}]),I(e,[{key:"onUpdate",value:function(e){F(this,X)[X].push(e)}},{key:"onPointerDown",value:function(e){F(this,Y)[Y].push(e)}},{key:"onPointerMove",value:function(e){F(this,$)[$].push(e)}},{key:"onPointerUp",value:function(e){F(this,J)[J].push(e)}},{key:"offUpdate",value:function(e){var t=F(this,X)[X].indexOf(e);-1!==t&&F(this,X)[X].splice(t,1)}},{key:"offPointerDown",value:function(e){var t=F(this,Y)[Y].indexOf(e);-1!==t&&F(this,Y)[Y].splice(t,1)}},{key:"offPointerMove",value:function(e){var t=F(this,$)[$].indexOf(e);-1!==t&&F(this,$)[$].splice(t,1)}},{key:"offPointerUp",value:function(e){var t=F(this,J)[J].indexOf(e);-1!==t&&F(this,J)[J].splice(t,1)}},{key:"width",get:function(){return F(this,q)[q]||window.innerWidth}},{key:"height",get:function(){return F(this,H)[H]||window.innerHeight}},{key:"pixelRatio",get:function(){return Math.min(this.maxPixelRatio,window.devicePixelRatio)}},{key:"cursor",get:function(){return this.canvas.style.cursor},set:function(e){this.canvas.style.cursor=e||null}}]),e}();function Z(e,t){var n=d()(t),r=document.createElement("a");r.download=e,r.href=window.URL.createObjectURL(n),r.onclick=setTimeout((function(){window.URL.revokeObjectURL(n),r.removeAttribute("href")}),0),r.click()}n(43),n(87),n(254),n(137);var ee=n(165),te=n.n(ee),ne=n(57),re=n.n(ne),oe=n(166),ie=n(167),ae=n.n(ie);function ce(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var se=n(172);function le(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function ue(e,t){var n,r=t.renderer,o=le(t,["renderer"]);if(!r)throw new Error("Env map requires renderer to passed in the options for ".concat(e,"!"));if(!Array.isArray(e)){var i=e.slice(e.lastIndexOf(".")+1);switch(i){case"hdr":n=(new RGBELoader).setDataType(a.fc).loadAsync(e);break;case"exr":n=(new se.a).setDataType(a.fc).loadAsync(e);break;case"png":case"jpg":n=(new a.ac).loadAsync(e).then((function(e){return r.outputEncoding!==a.pc||o.linear||(e.encoding=a.pc),e}));break;default:throw new Error("Extension ".concat(i," not supported"))}n=n.then((function(e){return o.pmrem?function(e,t){var n=new a.xb(t);n.compileEquirectangularShader();var r=n.fromEquirectangular(e);return n.dispose(),e.dispose(),e.image.data=null,r.texture}(e,r):function(e){return e.mapping=a.y,e}(e)}))}else{var c=e[0].slice(e.lastIndexOf(".")+1);switch(c){case"hdr":n=(new HDRCubeTextureLoader).setDataType(a.fc).loadAsync(e);break;case"png":case"jpg":n=(new a.o).loadAsync(e).then((function(e){return r.outputEncoding!==a.pc||o.linear||(e.encoding=a.pc),e}));break;default:throw new Error("Extension ".concat(c," not supported"))}n=n.then((function(e){return o.pmrem?function(e,t){var n=new a.xb(t);n.compileCubemapShader();var r=n.fromCubemap(e);return n.dispose(),e.dispose(),e.image.data=null,r.texture}(e,r):e}))}return Object.keys(o).filter((function(e){return!["pmrem","linear"].includes(e)})).forEach((function(e){n=n.then((function(t){return t[e]=o[e],t}))})),n}var fe=n(168),de=n(169);function pe(e){return function(e){if(Array.isArray(e))return he(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return he(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return he(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ve(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function me(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ve(i,r,o,a,c,"next",e)}function c(e){ve(i,r,o,a,c,"throw",e)}a(void 0)}))}}function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oe(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Pe=0;function je(e){return"__private_"+Pe+++"_"+e}var _e=je("queue"),ke=je("loaded"),Se=je("onProgressListeners"),Ee=je("asyncConcurrency"),Ce=je("logs"),De=new(function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,_e,{writable:!0,value:[]}),Object.defineProperty(this,ke,{writable:!0,value:{}}),Object.defineProperty(this,Se,{writable:!0,value:[]}),Object.defineProperty(this,Ee,{writable:!0,value:10}),Object.defineProperty(this,Ce,{writable:!0,value:[]}),this.get=function(e){if(!e)throw new TypeError("Must specify an URL for AssetManager.get()");return Oe(t,ke)[ke][e]}}var t,n,r,o,i;return t=e,(n=[{key:"addProgressListener",value:function(e){if("function"!=typeof e)throw new TypeError("onProgress must be a function");Oe(this,Se)[Se].push(e)}},{key:"queue",value:function(e){var t=e.url,n=e.type,r=we(e,["url","type"]);if(!t)throw new TypeError("Must specify a URL or opt.url for AssetManager.queue()");var o=this._getQueued(t);if(o){var i=ae()(o,["url","type"]);if(JSON.stringify(r)!==JSON.stringify(i)){var a=performance.now().toFixed(3).replace(".",""),c="".concat(t,".").concat(a);return Oe(this,_e)[_e].push(ye({key:c,url:t,type:n||this._extractType(t)},r)),c}return o.url}return Oe(this,_e)[_e].push(ye({url:t,type:n||this._extractType(t)},r)),t}},{key:"_getQueued",value:function(e){return Oe(this,_e)[_e].find((function(t){return t.url===e}))}},{key:"_extractType",value:function(e){var t=e.slice(e.lastIndexOf("."));switch(!0){case/\.(gltf|glb)$/i.test(t):return"gltf";case/\.json$/i.test(t):return"json";case/\.svg$/i.test(t):return"svg";case/\.(jpe?g|png|gif|bmp|tga|tif)$/i.test(t):return"image";case/\.(wav|mp3)$/i.test(t):return"audio";case/\.(mp4|webm|ogg|ogv)$/i.test(t):return"video";default:throw new Error("Could not load ".concat(e,", unknown file extension!"))}}},{key:"loadSingle",value:(i=me(regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.renderer,r=we(t,["renderer"]),n){e.next=3;break}throw new Error("You must provide a renderer to the loadSingle function.");case 3:if(e.prev=3,o=performance.now(),(i=r.key||r.url)in Oe(this,ke)[ke]){e.next=10;break}return e.next=9,this._loadItem(ye({renderer:n},r));case 9:Oe(this,ke)[ke][i]=e.sent;case 10:return window.DEBUG&&console.log("\ud83d\udce6 Loaded single asset %c".concat(r.url,"%c in ").concat(re()(performance.now()-o,{secondsDecimalDigits:3})),"color:blue","color:black"),e.abrupt("return",i);case 14:e.prev=14,e.t0=e.catch(3),console.error("\ud83d\udce6 Asset ".concat(r.url," was not loaded:\n").concat(e.t0));case 17:case"end":return e.stop()}}),e,this,[[3,14]])}))),function(e){return i.apply(this,arguments)})},{key:"load",value:(o=me(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.renderer){e.next=3;break}throw new Error("You must provide a renderer to the load function.");case 3:if(r=Oe(this,_e)[_e].slice(),Oe(this,_e)[_e].length=0,0!==(o=r.length)){e.next=9;break}return setTimeout((function(){return Oe(c,Se)[Se].forEach((function(e){return e(1)}))}),0),e.abrupt("return");case 9:return i=performance.now(),e.next=12,te()(r,function(){var e=me(regeneratorRuntime.mark((function e(t,r){var i,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=performance.now(),(a=t.key||t.url)in Oe(c,ke)[ke]){e.next=7;break}return e.next=6,c._loadItem(ye({renderer:n},t));case 6:Oe(c,ke)[ke][a]=e.sent;case 7:window.DEBUG&&c.log("Loaded %c".concat(t.url,"%c in ").concat(re()(performance.now()-i,{secondsDecimalDigits:3})),"color:blue","color:black"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),c.logError("Asset ".concat(t.url," was not loaded:\n").concat(e.t0));case 13:s=(r+1)/o,Oe(c,Se)[Se].forEach((function(e){return e(s)}));case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),{concurrency:Oe(this,Ee)[Ee]});case 12:window.DEBUG&&(0===(a=Oe(this,Ce)[Ce].filter((function(e){return"error"===e.type}))).length?this.groupLog("\ud83d\udce6 Assets loaded in ".concat(re()(performance.now()-i,{secondsDecimalDigits:3})," \u23f1")):this.groupLog("\ud83d\udce6 %c Could not load ".concat(a.length," asset").concat(a.length>1?"s":""," "),"color:white;background:red;"));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"_loadItem",value:function(e){var t=e.url,n=e.type,r=e.renderer,o=we(e,["url","type","renderer"]);switch(n){case"gltf":return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,r){var o=new fe.a;if(t.meshOpt)o.setMeshoptDecoder(MeshoptDecoder);else if(t.draco){var i=new de.a;i.setDecoderPath("https://www.gstatic.com/draco/v1/decoders/"),o.setDRACOLoader(i)}o.load(e,n,null,(function(t){return r(new Error("Could not load GLTF asset ".concat(e,":\n").concat(t)))}))}))}(t,o);case"json":return fetch(t).then((function(e){return e.json()}));case"envmap":case"envMap":case"env-map":return ue(t,ye({renderer:r},o));case"svg":case"image":return Object(oe.a)(t,{crossorigin:"anonymous"});case"texture":return function(e,t){var n=t.renderer,r=ce(t,["renderer"]);if(!n)throw new Error("Texture requires renderer to passed in the options for ".concat(e,"!"));return new Promise((function(t,o){(new a.ac).load(e,(function(e){n.outputEncoding!==a.pc||r.linear||(e.encoding=a.pc),Object.keys(r).filter((function(e){return!["linear"].includes(e)})).forEach((function(t){e[t]=r[t]})),n.initTexture(e),t(e)}),null,(function(t){return o(new Error("Could not load texture ".concat(e,":\n").concat(t)))}))}))}(t,ye({renderer:r},o));case"audio":return fetch(t).then((function(e){return e.arrayBuffer()}));case"video":return fetch(t).then((function(e){return e.blob()}));default:throw new Error("Could not load ".concat(t,", the type ").concat(n," is unknown!"))}}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Oe(this,Ce)[Ce].push({type:"log",text:t})}},{key:"logError",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Oe(this,Ce)[Ce].push({type:"error",text:t})}},{key:"groupLog",value:function(){var e;(e=console).groupCollapsed.apply(e,arguments),Oe(this,Ce)[Ce].forEach((function(e){var t;(t=console)[e.type].apply(t,pe(e.text))})),console.groupEnd(),Oe(this,Ce)[Ce].length=0}}])&&xe(t.prototype,n),r&&xe(t,r),e}());n(348);function Re(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){Ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Le(e,t){Ie(e),e.uniforms=t,e.addBeforeCompileListener((function(t){e.uniforms=Me(Me({},e.uniforms),t.uniforms),t.uniforms=e.uniforms})),Fe(e)}function ze(e,t){Ie(e),e.addBeforeCompileListener((function(e){e.vertexShader=Ne(e.vertexShader,t)})),Fe(e)}function Ue(e,t){Ie(e),e.addBeforeCompileListener((function(e){e.fragmentShader=Ne(e.fragmentShader,t)})),Fe(e)}function Ie(e){e.beforeCompileListeners||(e.beforeCompileListeners=[],e.addBeforeCompileListener=function(t){e.beforeCompileListeners.push(t)})}function Fe(e){e.onBeforeCompile=function(t){e.beforeCompileListeners.forEach((function(e){return e(t)}))}}function Ne(e,t){var n=t.defines,r=void 0===n?"":n,o=t.head,i=void 0===o?"":o,a=t.main,c=void 0===a?"":a,s=t.transformed,l=t.objectNormal,u=t.transformedNormal,f=t.diffuse,d=t.emissive,p=t.gl_FragColor,h=Re(t,["defines","head","main","transformed","objectNormal","transformedNormal","diffuse","emissive","gl_FragColor"]),v=e,m=function(e,t,n){return e.split(t).join(n)};Object.keys(h).forEach((function(e){v=m(v,e,h[e])})),v=v.replace("void main() {","\n    ".concat(i,"\n    void main() {\n      ").concat(c,"\n    ")),s&&v.includes("#include <begin_vertex>")&&(v=v.replace("#include <begin_vertex>","#include <begin_vertex>\n      ".concat(s,"\n      "))),l&&v.includes("#include <beginnormal_vertex>")&&(v=v.replace("#include <beginnormal_vertex>","#include <beginnormal_vertex>\n      ".concat(l,"\n      "))),u&&v.includes("#include <defaultnormal_vertex>")&&(v=v.replace("#include <defaultnormal_vertex>","#include <defaultnormal_vertex>\n      ".concat(u,"\n      "))),f&&v.includes("vec4 diffuseColor = vec4( diffuse, opacity );")&&(v=v.replace("vec4 diffuseColor = vec4( diffuse, opacity );","\n      vec3 diffuse_;\n      ".concat(m(f,"diffuse =","diffuse_ ="),"\n      vec4 diffuseColor = vec4(diffuse_, opacity);\n      "))),d&&v.includes("vec3 totalEmissiveRadiance = emissive;")&&(v=v.replace("vec3 totalEmissiveRadiance = emissive;","\n      vec3 emissive_;\n      ".concat(m(d,"emissive =","emissive_ ="),"\n      vec3 totalEmissiveRadiance = emissive_;\n      "))),p&&v.includes("gl_FragColor = vec4( outgoingLight, diffuseColor.a );")&&(v=v.replace("gl_FragColor = vec4( outgoingLight, diffuseColor.a );","\n        gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n        ".concat(p,"\n      ")));var b=Object.keys(r).map((function(e){return"#define ".concat(e," ").concat(r[e])})).join("\n");return"\n    ".concat(b,"\n    ").concat(v,"\n  ")}var Be=De.queue({url:"assets/ephebe_twerking.glb",type:"gltf"}),qe=De.queue({url:"assets/envMaps/49TH_STREET.exr",type:"envmap",pmrem:!0});function He(e){var t,n=De.get(Be),r=n.scene;r.traverse((function(e){e.isMesh&&(t=e)})),t.frustumCulled=!1;var o=new a.c(r),i=n.animations[0];return o.clipAction(i).play(),t.material=new a.lb({skinning:!0,roughness:.25,metalness:1,envMap:De.get(qe)}),Le(t.material,{time:{value:0},powerFactor:R(t.material,(function(){return e.controls.ephebe.powerFactor})),multiplicator:R(t.material,(function(){return e.controls.ephebe.multiplicator}))}),ze(t.material,{head:"\n      out vec3 vTransformed;\n    ","#include <skinning_vertex>":"\n      #include <skinning_vertex>\n\n      vTransformed = vec3(modelMatrix * vec4(transformed, 1.0));\n    ",transformedNormal:"\n      transformedNormal = mat3(modelMatrix) * objectNormal;\n    "}),Ue(t.material,{head:"\n      uniform float time;\n      uniform float powerFactor;\n      uniform float multiplicator;\n\n      in vec3 vTransformed;\n\n      float hue2rgb_194831225(float f1, float f2, float hue) {\n    if (hue < 0.0)\n        hue += 1.0;\n    else if (hue > 1.0)\n        hue -= 1.0;\n    float res;\n    if ((6.0 * hue) < 1.0)\n        res = f1 + (f2 - f1) * 6.0 * hue;\n    else if ((2.0 * hue) < 1.0)\n        res = f2;\n    else if ((3.0 * hue) < 2.0)\n        res = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;\n    else\n        res = f1;\n    return res;\n}\n\nvec3 hsl2rgb(vec3 hsl) {\n    vec3 rgb;\n    \n    if (hsl.y == 0.0) {\n        rgb = vec3(hsl.z); // Luminance\n    } else {\n        float f2;\n        \n        if (hsl.z < 0.5)\n            f2 = hsl.z * (1.0 + hsl.y);\n        else\n            f2 = hsl.z + hsl.y - hsl.y * hsl.z;\n            \n        float f1 = 2.0 * hsl.z - f2;\n        \n        rgb.r = hue2rgb_194831225(f1, f2, hsl.x + (1.0/3.0));\n        rgb.g = hue2rgb_194831225(f1, f2, hsl.x);\n        rgb.b = hue2rgb_194831225(f1, f2, hsl.x - (1.0/3.0));\n    }   \n    return rgb;\n}\n\nvec3 hsl2rgb(float h, float s, float l) {\n    return hsl2rgb(vec3(h, s, l));\n}\n\n      float blendOverlay(float base, float blend) {\n\treturn base<0.5?(2.0*base*blend):(1.0-2.0*(1.0-base)*(1.0-blend));\n}\n\nvec3 blendOverlay(vec3 base, vec3 blend) {\n\treturn vec3(blendOverlay(base.r,blend.r),blendOverlay(base.g,blend.g),blendOverlay(base.b,blend.b));\n}\n\nvec3 blendOverlay(vec3 base, vec3 blend, float opacity) {\n\treturn (blendOverlay(base, blend) * opacity + base * (1.0 - opacity));\n}\n\n    ",main:"\n      vec3 cameraDirection = normalize(cameraPosition - vTransformed);\n\n      // 1 when facing the camera, 0 when perpendicular\n      float fresnel = dot(vNormal, cameraDirection);\n\n      float iridescence = pow(fresnel, powerFactor) * multiplicator;\n\n      // circle the whole hue wheel,\n      // the function looks like this /|/|/|/|/\n      float f = mod(iridescence + time, 1.0);\n\n      vec3 iridescentColor = hsl2rgb(f, 1.0, 0.5);\n    ",diffuse:"\n      diffuse = iridescentColor;\n    ",gl_FragColor:"\n      gl_FragColor.rgb = blendOverlay(gl_FragColor.rgb, iridescentColor);\n    "}),r.scale.multiplyScalar(.25),r.rotateY(Math.PI),r.translateX(-.1),r.translateY(.15),e.onUpdate((function(n){o.update(n),t.material.uniforms.time.value+=n*e.controls.ephebe.speed})),r}function Ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xe(e,t){return(Xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Je(e);if(t){var o=Je(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $e(this,n)}}function $e(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Je(e){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qe=De.queue({url:"assets/envMaps/49TH_STREET.exr",type:"envmap",pmrem:!0}),Ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xe(e,t)}(i,e);var t,n,r,o=Ye(i);function i(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ge(this,i),(t=o.call(this,n)).webgl=e,t.options=n,t.material=new a.mb({roughness:.2,metalness:1,envMap:De.get(Qe),envMapIntensity:.5}),Le(t.material,{time:{value:0},timeFixed:{value:0},powerFactor:R(t.material,(function(){return t.webgl.controls.hills.powerFactor})),multiplicator:R(t.material,(function(){return t.webgl.controls.hills.multiplicator})),firstColor:R(t.material,(function(){return t.webgl.controls.hills.firstColor})),secondColor:R(t.material,(function(){return t.webgl.controls.hills.secondColor}))}),ze(t.material,{head:"\n        uniform float timeFixed;\n\n        out vec3 vPosition;\n\n        //\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_1635892720(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289_1635892720(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_1635892720(vec4 x) {\n     return mod289_1635892720(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1635892720(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat noise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D_1635892720 = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g_1635892720 = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g_1635892720;\n  vec3 i1 = min( g_1635892720.xyz, l.zxy );\n  vec3 i2 = max( g_1635892720.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D_1635892720.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289_1635892720(i);\n  vec4 p = permute_1635892720( permute_1635892720( permute_1635892720(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D_1635892720.wyz - D_1635892720.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1_1635892720 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0_1635892720 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1_1635892720.xy,h.z);\n  vec3 p3 = vec3(a1_1635892720.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt_1635892720(vec4(dot(p0_1635892720,p0_1635892720), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0_1635892720 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0_1635892720,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\n        float hypot (vec2 z_2219187843) {\n  float t;\n  float x = abs(z_2219187843.x);\n  float y = abs(z_2219187843.y);\n  t = min(x, y);\n  x = max(x, y);\n  t = t / x;\n  return (z_2219187843.x == 0.0 && z_2219187843.y == 0.0) ? 0.0 : x * sqrt(1.0 + t * t);\n}\n\n        // http://lolengine.net/blog/2013/09/21/picking-orthogonal-vector-combing-coconuts\n        vec3 orthogonal(vec3 v) {\n          return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0)\n          : vec3(0.0, -v.z, v.y));\n        }\n\n        // the function which defines the displacement\n        float frequency = 0.4;\n        float speed = 0.05;\n        float displace(vec3 point) {\n          // distance from center\n          float distance = hypot(point.xz);\n\n          float amplitude = pow(distance, 2.0) * 0.05;\n\n          return (noise(vec3(point.xz * frequency, timeFixed * speed)) * 0.5 + 0.5) * amplitude;\n        }\n      ",main:"\n        vec3 displacedPosition = position + normal * displace(position);\n\n        float offset = 0.078125;\n        vec3 tangent = orthogonal(normal);\n        vec3 bitangent = normalize(cross(normal, tangent));\n        vec3 neighbour1 = position + tangent * offset;\n        vec3 neighbour2 = position + bitangent * offset;\n        vec3 displacedNeighbour1 = neighbour1 + normal * displace(neighbour1);\n        vec3 displacedNeighbour2 = neighbour2 + normal * displace(neighbour2);\n\n        // https://i.ya-webdesign.com/images/vector-normals-tangent-16.png\n        vec3 displacedTangent = displacedNeighbour1 - displacedPosition;\n        vec3 displacedBitangent = displacedNeighbour2 - displacedPosition;\n\n        // https://upload.wikimedia.org/wikipedia/commons/d/d2/Right_hand_rule_cross_product.svg\n        vec3 displacedNormal = normalize(cross(displacedTangent, displacedBitangent));\n      ",transformed:"\n        transformed = displacedPosition;\n        vPosition = transformed;\n      ",objectNormal:"\n        objectNormal = displacedNormal;\n      ",transformedNormal:"\n        transformedNormal = mat3(modelMatrix) * objectNormal;\n      "}),Ue(t.material,{head:"\n        uniform float time;\n        uniform float powerFactor;\n        uniform float multiplicator;\n        uniform vec3 firstColor;\n        uniform vec3 secondColor;\n\n        in vec3 vPosition;\n      ",main:"\n        // The camera sometimes would be too close to the position,\n        // so the vector would point to the negative position.\n        // Multiplicating the camera position by a big number fixes it.\n        vec3 cameraDirection = normalize(cameraPosition * 1000.0 - vPosition);\n\n        // 1 when facing the camera, 0 when perpendicular\n        float fresnel = dot(vNormal, cameraDirection);\n\n        float iridescence = pow(fresnel, powerFactor) * multiplicator;\n\n        // pingPong function\n        // alternate between two colors,\n        // the function looks like this /////\n        float f = abs(1.0 - mod(iridescence + time, 2.0));\n\n        vec3 iridescentColor = mix(firstColor, secondColor, f);\n      ",diffuse:"\n        diffuse = iridescentColor;\n      "}),t.geometry=new a.Ab(20,20,256,256),t.geometry.rotateX(-Math.PI/2),t.mesh=new a.hb(t.geometry,t.material),t.add(t.mesh),t}return t=i,(n=[{key:"update",value:function(e,t){this.material.uniforms.time.value+=e*this.webgl.controls.hills.speed,this.material.uniforms.timeFixed.value=t}}])&&We(t.prototype,n),r&&We(t,r),i}(a.F);function Ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nt(e);if(t){var o=nt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tt(this,n)}}function tt(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nt(e){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rt={uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:"\n    uniform mat4 textureMatrix;\n    varying vec4 vUv;\n\n    void main() {\n      vUv = textureMatrix * vec4(position, 1.0);\n\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    uniform vec3 color;\n    uniform sampler2D tDiffuse;\n    varying vec4 vUv;\n\n    float blendOverlay(float base, float blend) {\n      return(base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)));\n    }\n\n    vec3 blendOverlay(vec3 base, vec3 blend) {\n      return vec3(blendOverlay(base.r, blend.r), blendOverlay(base.g, blend.g), blendOverlay(base.b, blend.b));\n    }\n\n    void main() {\n      vec4 base = texture2DProj(tDiffuse, vUv);\n      gl_FragColor = vec4(blendOverlay(base.rgb, color), base.a);\n    }\n  "},ot=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}(n,e);var t=et(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ke(this,n),(r=t.call(this,e)).type="Reflector";var i=o.renderer,s=o.scene,l=o.camera,u=o.composer,f=void 0!==o.color?new a.n(o.color):new a.n(8355711),d=o.textureWidth||512,p=o.textureHeight||512,h=o.clipBias||0,v=new a.zb,m=new a.jc,b=new a.jc,y=new a.jc,g=new a.gb,w=new a.jc(0,0,-1),x=new a.kc,O=new a.jc,P=new a.jc,j=new a.kc,_=new a.gb,k=new a.yb,S=new a.nc(d,p,{minFilter:a.U,magFilter:a.U,format:a.Ib,encoding:i.outputEncoding});r.renderTarget=S,a.eb.isPowerOfTwo(d)&&a.eb.isPowerOfTwo(p)||(S.texture.generateMipmaps=!1);var E,C,D=o.shader||rt,R=new a.Rb({uniforms:a.ec.clone(D.uniforms),fragmentShader:D.fragmentShader,vertexShader:D.vertexShader,transparent:!0});R.uniforms.tDiffuse.value=S.texture,R.uniforms.color.value=f,R.uniforms.textureMatrix.value=_,r.material=R;var T=function(){if(b.setFromMatrixPosition(r.matrixWorld),y.setFromMatrixPosition(l.matrixWorld),g.extractRotation(r.matrixWorld),m.set(0,0,1),m.applyMatrix4(g),O.subVectors(b,y),!(O.dot(m)>0)){O.reflect(m).negate(),O.add(b),g.extractRotation(l.matrixWorld),w.set(0,0,-1),w.applyMatrix4(g),w.add(y),P.subVectors(b,w),P.reflect(m).negate(),P.add(b),k.position.copy(O),k.up.set(0,1,0),k.up.applyMatrix4(g),k.up.reflect(m),k.lookAt(P),k.far=l.far,k.updateMatrixWorld(),k.projectionMatrix.copy(l.projectionMatrix),_.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),_.multiply(k.projectionMatrix),_.multiply(k.matrixWorldInverse),_.multiply(r.matrixWorld),v.setFromNormalAndCoplanarPoint(m,b),v.applyMatrix4(k.matrixWorldInverse),x.set(v.normal.x,v.normal.y,v.normal.z,v.constant);var e=k.projectionMatrix;j.x=(Math.sign(x.x)+e.elements[8])/e.elements[0],j.y=(Math.sign(x.y)+e.elements[9])/e.elements[5],j.z=-1,j.w=(1+e.elements[10])/e.elements[14],x.multiplyScalar(2/x.dot(j)),e.elements[2]=x.x,e.elements[6]=x.y,e.elements[10]=x.z+1-h,e.elements[14]=x.w,r.visible=!1,E=i.xr.enabled,C=i.shadowMap.autoUpdate,i.xr.enabled=!1,i.shadowMap.autoUpdate=!1,i.state.buffers.depth.setMask(!0)}},M=function(){r.visible=!0,i.xr.enabled=E,i.shadowMap.autoUpdate=C;var e=l.viewport;void 0!==e&&i.state.viewport(e)},A=new c.f(T),L=new c.g(s,k),z=new c.j(S),U=new c.f(M);return R.uniforms.tDiffuse.value=z.renderTarget.texture,u.addPass(A,0),u.addPass(L,1),u.addPass(z,2),u.addPass(U,3),r}return n}(a.hb);function it(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lt(e);if(t){var o=lt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return st(this,n)}}function st(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lt(e){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(n,e);var t=ct(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};it(this,n),(r=t.call(this,o)).webgl=e,r.options=o;var i=new a.l(2,32),c=new ot(i,{scene:o.reflected||e.scene,renderer:e.renderer,camera:e.camera,composer:e.composer,textureWidth:e.width,textureHeight:e.height,shader:{uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:"\n          uniform mat4 textureMatrix;\n          varying vec4 vUvProj;\n          varying vec2 vUv;\n\n          void main() {\n            vUv = uv;\n            vUvProj = textureMatrix * vec4(position, 1.0);\n\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          }\n        ",fragmentShader:"\n          uniform sampler2D tDiffuse;\n          varying vec4 vUvProj;\n          varying vec2 vUv;\n\n          float ease(float t) {\n  return pow(t - 1.0, 3.0) * (1.0 - t) + 1.0;\n}\n\n          void main() {\n            vec4 base = texture2DProj(tDiffuse, vUvProj);\n\n            gl_FragColor.xyz = base.rgb;\n\n            // fade out\n            vec2 center = vec2(0.5);\n            float distanceFactor = 1.2;\n            float startOpacity = 0.8;\n            float fadeOut = ease(min(distance(center, vUv) * 2.0 * distanceFactor, 1.0));\n            gl_FragColor.a = mix(base.a * startOpacity, 0.0, fadeOut);\n          }\n        "}});return c.position.y=.15,c.rotateX(-Math.PI/2),r.add(c),r}return n}(a.F);function ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pt(e,t,n){return t&&dt(e.prototype,t),n&&dt(e,n),e}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bt(e);if(t){var o=bt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mt(this,n)}}function mt(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bt(e){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(n,e);var t=vt(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ft(this,n),(r=t.call(this,o)).reticle=void 0,r.controller=void 0,r._pointerDownListeners=[],r._pointerUpListeners=[],r._firstHitListeners=[],r._hitTestSourceRequested=!1,r._hitTestSource=void 0,r._initialized=!1,r._onSelectStart=function(e){r._pointerDownListeners.forEach((function(t){return t(e,r.controller)}))},r._onSelectEnd=function(e){r._pointerUpListeners.forEach((function(t){return t(e,r.controller)}))},r.webgl=e,r.options=o,r.reticle=new a.hb(new a.Pb(.15,.2,64).rotateX(-Math.PI/2),new a.ib({transparent:!0,opacity:.3,depthWrite:!1})),r.reticle.matrixAutoUpdate=!1,r.reticle.visible=!1,window.DEBUG&&r.add(r.reticle),r.controller=r.webgl.renderer.xr.getController(0),r.add(r.controller),r.controller.addEventListener("selectstart",r._onSelectStart),r.controller.addEventListener("selectend",r._onSelectEnd),r}return pt(n,[{key:"isHitting",get:function(){return this.reticle.visible}}]),pt(n,[{key:"reset",value:function(){this.controller.removeEventListener("selectstart",this._onSelectStart),this.controller.removeEventListener("selectend",this._onSelectEnd),this._pointerDownListeners.length=0,this._pointerUpListeners.length=0,this._firstHitListeners.length=0,this._initialized=!1,this._hitTestSource=void 0,this._hitTestSourceRequested=!1}},{key:"onARPointerDown",value:function(e){this._pointerDownListeners.push(e)}},{key:"offARPointerDown",value:function(e){var t=this._pointerDownListeners.indexOf(e);-1!==t&&this._pointerDownListeners.splice(t,1)}},{key:"onARPointerUp",value:function(e){this._pointerUpListeners.push(e)}},{key:"offARPointerUp",value:function(e){var t=this._pointerUpListeners.indexOf(e);-1!==t&&this._pointerUpListeners.splice(t,1)}},{key:"onFirstHit",value:function(e){this._firstHitListeners.push(e)}},{key:"offFirstHit",value:function(e){var t=this._firstHitListeners.indexOf(e);-1!==t&&this._firstHitListeners.splice(t,1)}},{key:"getPose",value:function(e){var t=this;if(!this._hitTestSourceRequested){this._hitTestSourceRequested=!0;var n=this.webgl.renderer.xr.getSession();n.requestReferenceSpace("viewer").then((function(e){return n.requestHitTestSource({space:e})})).then((function(e){t._hitTestSource=e}))}if(this._hitTestSource){var r=e.getHitTestResults(this._hitTestSource);if(0!==r.length){var o=r[0],i=this.webgl.renderer.xr.getReferenceSpace();return o.getPose(i).transform.matrix}}}},{key:"update",value:function(e,t,n){if(n){var r=this.getPose(n);r?(this.reticle.visible=!0,this.reticle.matrix.fromArray(r),this.reticle.position.setFromMatrixPosition(this.reticle.matrix),this._initialized||(this._initialized=!0,this._firstHitListeners.forEach((function(e){return e(event,r)})))):this.reticle.visible=!1}}}]),n}(a.F);function gt(e,t,n){return(gt=wt()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&xt(o,n.prototype),o}).apply(null,arguments)}function wt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function xt(e,t){return(xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Promise((function(e){(new c.i).load((function(n){var r=Ot(n,2),o=r[0],i=r[1],a=gt(c.h,[o,i].concat(t));e(a)}))}))}function _t(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function kt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){_t(i,r,o,a,c,"next",e)}function c(e){_t(i,r,o,a,c,"throw",e)}a(void 0)}))}}function St(){return Et.apply(this,arguments)}function Et(){return(Et=kt(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("xr"in navigator){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,navigator.xr.isSessionSupported("immersive-ar");case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return",!1);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ct=n(170),Dt=n(171);function Rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mt(e,t){return(Mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function At(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zt(e);if(t){var o=zt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Lt(this,n)}}function Lt(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zt(e){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mt(e,t)}(i,e);var t,n,r,o=At(i);function i(e){var t,n,r,c,s,l,u,f,d,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Rt(this,i),(d=o.call(this,p)).webgl=e,d.options=p,d.object=d.options.object,d.RESOLUTION=null!==(t=p.resolution)&&void 0!==t?t:256,d.PLANE_WIDTH=null!==(n=p.width)&&void 0!==n?n:.26,d.PLANE_HEIGHT=null!==(r=p.height)&&void 0!==r?r:.26,d.CAMERA_DEPTH=null!==(c=p.depth)&&void 0!==c?c:.03,d.BLUR=null!==(s=p.blur)&&void 0!==s?s:4,d.BLUR_SECOND_PASS=null!==(l=p.blurSecondPass)&&void 0!==l?l:.4*d.BLUR,d.DARKNESS=null!==(u=p.darkness)&&void 0!==u?u:1,d.OPACITY=null!==(f=p.opacity)&&void 0!==f?f:1,d.renderTarget=new a.nc(d.RESOLUTION,d.RESOLUTION),d.renderTarget.texture.generateMipmaps=!1,d.renderTargetBlur=new a.nc(d.RESOLUTION,d.RESOLUTION),d.renderTargetBlur.texture.generateMipmaps=!1;var h=new a.Ab(d.PLANE_WIDTH,d.PLANE_HEIGHT).rotateX(Math.PI/2),v=new a.ib({map:d.renderTarget.texture,opacity:d.OPACITY,transparent:!0});return d.plane=new a.hb(h,v),d.add(d.plane),d.plane.scale.y=-1,d.blurPlane=new a.hb(h),d.add(d.blurPlane),d.blurPlane.visible=!1,d.shadowCamera=new a.wb(-d.PLANE_WIDTH/2,d.PLANE_WIDTH/2,d.PLANE_HEIGHT/2,-d.PLANE_HEIGHT/2,0,d.CAMERA_DEPTH),d.shadowCamera.rotation.x=Math.PI/2,d.add(d.shadowCamera),d.cameraHelper=new a.j(d.shadowCamera),d.depthMaterial=new a.jb,d.depthMaterial.skinning=!0,d.depthMaterial.depthTest=!1,d.depthMaterial.depthWrite=!1,Le(d.depthMaterial,{darkness:{value:d.DARKNESS}}),Ue(d.depthMaterial,{head:"\n        uniform float darkness;\n      ","gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":"\n        gl_FragColor = vec4(vec3(0.0), (1.0 - fragCoordZ) * darkness);\n      "}),d.horizontalBlurMaterial=new a.Rb(Ct.a),d.horizontalBlurMaterial.depthTest=!1,d.verticalBlurMaterial=new a.Rb(Dt.a),d.verticalBlurMaterial.depthTest=!1,d}return t=i,(n=[{key:"blurShadow",value:function(e){var t=a.eb.mapLinear;this.blurPlane.visible=!0,this.blurPlane.material=this.horizontalBlurMaterial,this.blurPlane.material.uniforms.tDiffuse.value=this.renderTarget.texture,this.horizontalBlurMaterial.uniforms.h.value=t(e,0,1,0,1/256),this.webgl.renderer.setRenderTarget(this.renderTargetBlur),this.webgl.renderer.clear(),this.webgl.renderer.render(this.blurPlane,this.shadowCamera),this.blurPlane.material=this.verticalBlurMaterial,this.blurPlane.material.uniforms.tDiffuse.value=this.renderTargetBlur.texture,this.verticalBlurMaterial.uniforms.v.value=t(e,0,1,0,1/256),this.webgl.renderer.setRenderTarget(this.renderTarget),this.webgl.renderer.clear(),this.webgl.renderer.render(this.blurPlane,this.shadowCamera),this.blurPlane.visible=!1}},{key:"update",value:function(e,t){var n=this,r=this.webgl.scene.background;this.webgl.scene.background=null;var o=this.webgl.renderer.xr.enabled;this.webgl.renderer.xr.enabled=!1,this.cameraHelper.visible=!1;var i={};this.object.traverse((function(e){e.isMesh&&(i[e.id]=e.material,e.material=n.depthMaterial)})),this.webgl.renderer.setRenderTarget(this.renderTarget),this.webgl.renderer.clear(),this.webgl.renderer.render(this.object,this.shadowCamera),this.blurShadow(this.BLUR),0!==this.BLUR_SECOND_PASS&&this.blurShadow(this.BLUR_SECOND_PASS),this.object.traverse((function(e){e.isMesh&&(e.material=i[e.id])})),this.cameraHelper.visible=!0,this.webgl.scene.background=r,this.webgl.renderer.xr.enabled=o,this.webgl.renderer.setRenderTarget(null)}}])&&Tt(t.prototype,n),r&&Tt(t,r),i}(a.F);function It(e){return function(e){if(Array.isArray(e))return Ft(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ft(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ft(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Nt(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Bt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Nt(i,r,o,a,c,"next",e)}function c(e){Nt(i,r,o,a,c,"throw",e)}a(void 0)}))}}window.DEBUG=window.location.search.includes("debug");var qt=new K({canvas:document.querySelector("#app"),backgroundAlpha:0,controls:{ephebe:{powerFactor:{value:.8,max:5},speed:{value:.1,max:10,scale:"exp"},multiplicator:{value:1,max:10,scale:"exp"}},hills:{powerFactor:{value:1.13,max:5},speed:{value:.3,max:10,scale:"exp"},multiplicator:{value:2.5,max:20,scale:"exp"},firstColor:"#CE1DC5",secondColor:"#73e600"}},closeControls:!window.DEBUG,showFps:window.DEBUG,cameraPosition:new a.jc(-1,2,5),orbitControls:{target:new a.jc(0,1.2,0),maxPolarAngle:window.DEBUG?Math.PI:Math.PI/1.94},xr:!0,gamma:!0,antialias:!1,maxPixelRatio:1,postprocessing:!0,multisampling:0});window.DEBUG&&(window.webgl=qt);var Ht=De.queue({url:"assets/envMaps/nebula_optimized.jpg",type:"envmap"});De.load({renderer:qt.renderer}).then(Bt(regeneratorRuntime.mark((function e(){var t,n,r,o,s,u,f,d,p,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=1,n=3,.7,5.05,2,.6,2,window.DEBUG||(qt.orbitControls.autoRotate=!0,qt.orbitControls.autoRotateSpeed=-2,qt.orbitControls.maxDistance=5.05,qt.orbitControls.minDistance=.7,qt.orbitControls.maxDistance=.7,qt.orbitControls.update(),qt.orbitControls.maxDistance=5.05,qt.orbitControls.update(),r=qt.time+t,qt.onUpdate((function(e,t){var o=l.a.quartInOut(i()((t-r)/n,0,1));qt.orbitControls.minDistance=o<1?a.eb.lerp(.7,5.05,o):.7})),o=qt.time+t+n-1,qt.onUpdate((function(e,t){var n=i()((t-o)/2,0,1);qt.orbitControls.autoRotateSpeed=n<1?-a.eb.lerp(2,.6,n):-.6}))),s=He(qt),qt.scene.add(s),u=new Ve(qt),qt.scene.add(u),f=new ut(qt,{reflected:s}),qt.scene.add(f),qt.scene.background=De.get(Ht),d=new c.b({blendFunction:c.a.ADD,kernelSize:c.e.LARGE,luminanceThreshold:.4,luminanceSmoothing:.15,height:480}),p=new c.k,e.next=19,jt();case 19:h=e.sent,qt.composer.addPass(new c.d(qt.camera,h,d,p)),qt.start(),St(qt.renderer.xr).then((function(e){if(e){var r=document.querySelector("#ar-button"),o=document.querySelector("#ar-ui"),i=o.querySelector("#ar-close-button"),c=qt.scene,l=new a.Qb,u=new yt(qt);l.add(u);var f=new Ut(qt,{object:s,resolution:256,width:.26,height:.26,depth:.03});if(r.style.display="block",window.DEBUG?r.style.opacity=1:setTimeout((function(){r.style.opacity=1}),1e3*(qt.time+t+n)),window.DEBUG)o.appendChild(qt.stats.dom),It(qt.stats.dom.children).forEach((function(e){e.style.top="1rem"}));r.addEventListener("click",(function(){var e;(e=qt.renderer.xr,navigator.xr.requestSession("immersive-ar",{requiredFeatures:["local","hit-test","dom-overlay"],domOverlay:{root:document.querySelector("#ar-ui")}}).then(function(){var t=kt(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setReferenceSpaceType("local"),t.next=3,e.setSession(n);case 3:return t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())).then((function(e){qt.scene=l,qt.orbitControls.enabled=!1;var t=qt.camera.position.clone(),n=s.position.clone(),r=s.scale.clone();o.style.display="block",u.onFirstHit((function(){c.remove(s),l.add(s),s.position.copy(u.reticle.position),s.scale.multiplyScalar(.1),l.add(f),window.DEBUG&&l.add(f.cameraHelper),f.position.copy(u.reticle.position)})),u.onARPointerDown((function(){u.isHitting&&(s.position.copy(u.reticle.position),f.position.copy(u.reticle.position))})),i.addEventListener("click",(function(){return e.end()}),{once:!0}),e.addEventListener("end",(function(){qt.scene=c,qt.orbitControls.enabled=!0,qt.camera.position.copy(t),u.reset(),o.style.display="none",l.remove(s),c.add(s),s.position.copy(n),s.scale.copy(r),l.remove(f),window.DEBUG&&l.remove(f.cameraHelper)}))})).catch((function(){}))}))}}));case 23:case"end":return e.stop()}}),e)}))))}});
//# sourceMappingURL=app.2f208ced.js.map